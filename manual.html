
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>The Neat Language &#8212; Neat  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Standard Library" href="std.html" />
    <link rel="prev" title="Introduction" href="intro.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="the-neat-language">
<h1>The Neat Language<a class="headerlink" href="#the-neat-language" title="Permalink to this heading"></a></h1>
<p>This document goes through every Neat language feature in approximate sequence.
The goal is that you should be able to understand the entire language by just
reading it top to bottom. But you can also use it as a reference to
quickly find how a feature works.</p>
<section id="lexical">
<h2>Lexical<a class="headerlink" href="#lexical" title="Permalink to this heading"></a></h2>
<p>All Neat source files are encoded as UTF-8.</p>
<p>Comment syntax is as in C:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="cm">/**</span>
<span class="cm"> * This is a comment. It goes from /* to */</span><span class="p">.</span><span class="w"></span>
<span class="w"> </span><span class="p">*/</span><span class="w"></span>
<span class="c1">// This is also a comment. It goes to the end of the line.</span><span class="w"></span>
<span class="cm">/* Comments can be /* nested. */</span><span class="w"> </span><span class="p">*/</span><span class="w"></span>
</pre></div>
</div>
<p>Comments may appear anywhere in a source file except inside identifiers or operators.</p>
<p>An identifier is a letter or underscore, followed by a sequence of letters, digits or underscores.</p>
</section>
<section id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Permalink to this heading"></a></h2>
<p>A Neat source file has the extension <code class="code docutils literal notranslate"><span class="pre">.nt</span></code>. Each source file corresponds to a module.
A module is a dot-separated list of packages, corresponding to folders, followed the filename.</p>
<p>Every file must begin with the module declaration. For instance, a file <code class="code docutils literal notranslate"><span class="pre">src/hello/world.nt</span></code>:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">module</span><span class="w"> </span><span class="n">hello</span><span class="p">.</span><span class="n">world</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="packages">
<h2>Packages<a class="headerlink" href="#packages" title="Permalink to this heading"></a></h2>
<p>Neat does not use includes, but instead packages. A package is a folder associated with a name:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ # -P&lt;name&gt;:&lt;folder&gt;[:&lt;dependency&gt;[,&lt;dependency]*]
$ neat -Proot:src src/hello/world.nt
</pre></div>
</div>
<p>This defines the folder <code class="code docutils literal notranslate"><span class="pre">./src</span></code> to be the package <code class="code docutils literal notranslate"><span class="pre">root</span></code>. The file passed will be the module
<code class="code docutils literal notranslate"><span class="pre">hello.world</span></code>, because its name will be relative to <code class="code docutils literal notranslate"><span class="pre">src</span></code>.</p>
<p>Packages cannot access modules in other packages. To allow a package access, explicitly
list the packages that it has access to:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="p">$</span><span class="w"> </span><span class="n">neat</span><span class="w"> </span><span class="p">-</span><span class="n">Proot</span><span class="p">:</span><span class="n">src</span><span class="p">:</span><span class="n">dep1</span><span class="p">,</span><span class="n">dep2</span><span class="w"> </span><span class="p">-</span><span class="n">Pdep1</span><span class="p">:</span><span class="n">include</span><span class="p">/</span><span class="n">dep1</span><span class="w"> </span><span class="p">-</span><span class="n">Pdep2</span><span class="p">:</span><span class="n">include</span><span class="p">/</span><span class="n">dep2</span><span class="w"></span>
</pre></div>
</div>
<p>This allows the modules from package <code class="code docutils literal notranslate"><span class="pre">root</span></code> in <code class="code docutils literal notranslate"><span class="pre">src/</span></code> to import the modules
in <code class="code docutils literal notranslate"><span class="pre">dep1</span></code> and <code class="code docutils literal notranslate"><span class="pre">dep2</span></code>.
Because dependencies are explicitly listed, accidental import of modules from
an unrelated package is impossible.</p>
</section>
<section id="module-level-statements">
<h2>Module-Level Statements<a class="headerlink" href="#module-level-statements" title="Permalink to this heading"></a></h2>
<section id="import">
<h3>Import<a class="headerlink" href="#import" title="Permalink to this heading"></a></h3>
<p>A module can import another module:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">module</span><span class="w"> </span><span class="n">hello</span><span class="p">.</span><span class="n">world</span><span class="p">;</span><span class="w"></span>

<span class="k">import</span><span class="w"> </span><span class="n">std</span><span class="p">.</span><span class="n">stdio</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Import is non-transitive, ie. symbols from modules imported by <code class="code docutils literal notranslate"><span class="pre">std.stdio</span></code> are invisible.</p>
<p>Modules can be imported transitively:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">module</span><span class="w"> </span><span class="n">first</span><span class="p">;</span><span class="w"></span>

<span class="k">public</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="n">second</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Now all modules that import <code class="code docutils literal notranslate"><span class="pre">first</span></code> will also see the symbols in <code class="code docutils literal notranslate"><span class="pre">second</span></code>.</p>
<p>Symbols can be imported by name: <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">std.stdio</span> <span class="pre">:</span> <span class="pre">print;</span></code>.</p>
</section>
<section id="declaration">
<h3>Declaration<a class="headerlink" href="#declaration" title="Permalink to this heading"></a></h3>
<p>Structs, classes, templates and functions can be declared by name.
Every declaration can be marked as <code class="code docutils literal notranslate"><span class="pre">public</span></code> or <code class="code docutils literal notranslate"><span class="pre">private</span></code>; they are <code class="code docutils literal notranslate"><span class="pre">public</span></code> by default.
Private declarations cannot be seen when the module is imported.</p>
</section>
<section id="extern-c">
<h3>Extern(C)<a class="headerlink" href="#extern-c" title="Permalink to this heading"></a></h3>
<p>A function can be declared as <code class="code docutils literal notranslate"><span class="pre">extern(C)</span></code>. This will ensure that it matches the calling convention of the platform’s native C compiler.</p>
<p>For example:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="kt">void</span><span class="p">*</span><span class="w"> </span><span class="n">memcpy</span><span class="p">(</span><span class="kt">void</span><span class="p">*</span><span class="w"> </span><span class="n">dest</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="p">*</span><span class="w"> </span><span class="n">src</span><span class="p">,</span><span class="w"> </span><span class="nb">size_t</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Note: instead of declaring lots of extern(C) functions manually, try using the
<code class="code docutils literal notranslate"><span class="pre">std.macro.cimport</span></code> built-in macro! (Grep for examples.)</p>
</section>
</section>
<section id="expressions">
<h2>Expressions<a class="headerlink" href="#expressions" title="Permalink to this heading"></a></h2>
<section id="literals">
<h3>Literals<a class="headerlink" href="#literals" title="Permalink to this heading"></a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">5</span></code> is an integer literal of type <code class="code docutils literal notranslate"><span class="pre">int</span></code>.</p>
<p>Integer literals may be arbitrarily divided by underscores for readability: <code class="code docutils literal notranslate"><span class="pre">1_048_576</span></code>.</p>
<p><code class="code docutils literal notranslate"><span class="pre">&quot;Hello</span> <span class="pre">World&quot;</span></code> is a string literal. <code class="code docutils literal notranslate"><span class="pre">string</span></code> is the same as <code class="code docutils literal notranslate"><span class="pre">char[]</span></code>.</p>
<p><code class="code docutils literal notranslate"><span class="pre">1.2</span></code> is a <code class="code docutils literal notranslate"><span class="pre">double</span></code> literal. <code class="code docutils literal notranslate"><span class="pre">1.2f</span></code> is a <code class="code docutils literal notranslate"><span class="pre">float</span></code> literal.</p>
</section>
<section id="arithmetic">
<h3>Arithmetic<a class="headerlink" href="#arithmetic" title="Permalink to this heading"></a></h3>
<p>Binary operations can be performed on types. These are:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 52%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Rank</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">||</span> <span class="pre">b</span></code></p></td>
<td><p>Boolean “or”</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">&amp;&amp;</span> <span class="pre">b</span></code></p></td>
<td><p>Boolean “and”</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">&lt;=</span> <span class="pre">b</span></code></p></td>
<td><p>Comparison</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">..</span> <span class="pre">b</span></code></p></td>
<td><p>Range</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">&lt;&lt;</span> <span class="pre">b</span></code></p></td>
<td><p>Left shift</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;&gt;</span> <span class="pre">b</span></code></p></td>
<td><p>Right shift</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code></p></td>
<td><p>Addition</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">-</span> <span class="pre">b</span></code></p></td>
<td><p>Subtraction</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">~</span> <span class="pre">b</span></code></p></td>
<td><p>Concatenation</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">*</span> <span class="pre">b</span></code></p></td>
<td><p>Multiplication</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">/</span> <span class="pre">b</span></code></p></td>
<td><p>Division</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">|</span> <span class="pre">b</span></code></p></td>
<td><p>Bitwise “or”</p></td>
<td><p>7</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">^</span> <span class="pre">b</span></code></p></td>
<td><p>Bitwise “xor”</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">a</span> <span class="pre">&amp;</span> <span class="pre">b</span></code></p></td>
<td><p>Bitwise “and”</p></td>
<td><p>9</p></td>
</tr>
</tbody>
</table>
<p>Boolean “or” and “and” are short-circuiting. Comparison operators are <code class="code docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="code docutils literal notranslate"><span class="pre">==</span></code>, <code class="code docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="code docutils literal notranslate"><span class="pre">&gt;=</span></code>, <code class="code docutils literal notranslate"><span class="pre">&lt;=</span></code>, and <code class="code docutils literal notranslate"><span class="pre">!=</span></code>.
Higher-ranked operators take precedence over lower-ranked, with boolean operators being the loosest.</p>
<p>Note that the placement of bitwise operators diverges from C’s order.
This is because C’s order is stupid^W a legacy holdover from before it had boolean operators.</p>
<p>Operator precedence can be clarified using parentheses: <code class="code docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">(3</span> <span class="pre">+</span> <span class="pre">4)</span></code> instead of <code class="code docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">3</span> <span class="pre">+</span> <span class="pre">4</span></code>.</p>
</section>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this heading"></a></h2>
<p>A function is a series of statements operating on a list of parameters, culminating in a return value:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="n">ReturnType</span><span class="w"> </span><span class="n">functionName</span><span class="p">(</span><span class="n">ParameterType</span><span class="w"> </span><span class="n">parameterName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">statement</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">statement</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">statement</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
<span class="w">    </span><span class="n">ReturnType</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">functionName</span><span class="p">(</span><span class="n">foo</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>When a function is called with <code class="code docutils literal notranslate"><span class="pre">name(arg,</span> <span class="pre">arg)</span></code>, the arguments are passed to the parameters and
control passes to the function. The statements of the function are then executed, until control
returns to the caller when the function exits, by explicit <code class="code docutils literal notranslate"><span class="pre">return</span></code> or reaching its end.</p>
<section id="call">
<h3>Call<a class="headerlink" href="#call" title="Permalink to this heading"></a></h3>
<p>A function, class method or struct method can be called with a comma-separated list of arguments:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Hello World&quot;</span><span class="p">);</span><span class="w"></span>

<span class="kt">double</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="mf">0.0</span><span class="p">);</span><span class="w"></span>

<span class="k">class</span><span class="p">.</span><span class="n">method</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
<p>When a function does not have any parameters, the empty parens can be left out, and the function will be
called implicitly:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="n">doWork</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>This also allows struct or class methods that look like properties.</p>
<section id="uniform-function-call-syntax">
<h4>Uniform Function Call Syntax<a class="headerlink" href="#uniform-function-call-syntax" title="Permalink to this heading"></a></h4>
<p>As in D, “uniform function call syntax” may be used. That is, if a call of the form <code class="code docutils literal notranslate"><span class="pre">a.method(b)</span></code>
did not find a method <code class="code docutils literal notranslate"><span class="pre">a.method</span></code> to call, it will instead be interpreted as <code class="code docutils literal notranslate"><span class="pre">method(a,</span> <span class="pre">b)</span></code>.
This allows easily defining global functions that can be called as if they are member functions of <code class="code docutils literal notranslate"><span class="pre">a</span></code>.</p>
</section>
<section id="named-arguments">
<h4>Named Arguments<a class="headerlink" href="#named-arguments" title="Permalink to this heading"></a></h4>
<p>The value of every parameter on a call may be assigned by name:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">twice</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="k">assert</span><span class="p">(</span><span class="n">twice</span><span class="p">(</span><span class="n">x</span><span class="p">=</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>This feature does not allow reordering parameters! It is purely intended to improve call readability, and to
ensure that arguments are passed to the intended parameter.</p>
</section>
</section>
<section id="nested-functions">
<h3>Nested functions<a class="headerlink" href="#nested-functions" title="Permalink to this heading"></a></h3>
<p>Functions may be nested inside other functions. They remain valid while the surrounding function is running,
and can access variables and parameters of the containing function, that were declared before them:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="kt">double</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Note that calling the nested function after the surrounding function has returned will lead to a crash!</p>
</section>
<section id="main">
<h3>main<a class="headerlink" href="#main" title="Permalink to this heading"></a></h3>
<p>Every program must contain a function with this signature:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">main</span><span class="p">(</span><span class="nb">string</span><span class="p">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>This function will be called when the program is executed.</p>
</section>
</section>
<section id="statements">
<h2>Statements<a class="headerlink" href="#statements" title="Permalink to this heading"></a></h2>
<section id="variable-declaration">
<h3>Variable declaration<a class="headerlink" href="#variable-declaration" title="Permalink to this heading"></a></h3>
<p>A variable can be declared like so:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w"> </span><span class="c1">// a is 0</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w"> </span><span class="c1">// c is 0</span><span class="w"></span>
<span class="n">mut</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">e</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Instead of a type, you may write <code class="code docutils literal notranslate"><span class="pre">auto</span></code>:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<p>Then the type of the variable is taken from the type of the initializer.</p>
<p>Only mutable variables (<code class="code docutils literal notranslate"><span class="pre">mut</span> <span class="pre">a;</span></code>) may be changed later.</p>
</section>
<section id="variable-extraction-declaration">
<h3>Variable extraction declaration<a class="headerlink" href="#variable-extraction-declaration" title="Permalink to this heading"></a></h3>
<p>When an expression is a sumtype, a subset or a single type may be extracted as such:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="n">Error</span><span class="p">)</span><span class="w"> </span><span class="n">foo</span><span class="p">;</span><span class="w"></span>
<span class="c1">// `Error` will be returned if `foo` is not `int`.</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="p">&lt;-</span><span class="w"> </span><span class="n">foo</span><span class="p">;</span><span class="w"></span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This syntax is disabled pending renovations!
The new error propagation syntax <code class="code docutils literal notranslate"><span class="pre">foo?.bar</span></code> has made it superfluous.</p>
</div>
</section>
<section id="block-statement">
<h3>Block statement<a class="headerlink" href="#block-statement" title="Permalink to this heading"></a></h3>
<p>Multiple statements can be combined into one block:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s">&quot;World&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Variables declared inside the block are not visible outside of it.</p>
</section>
<section id="expression-statement">
<h3>Expression statement<a class="headerlink" href="#expression-statement" title="Permalink to this heading"></a></h3>
<p>Expressions can appear as statements. They are terminated with a semicolon:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="n">foo</span><span class="p">();</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="assignment">
<h3>Assignment<a class="headerlink" href="#assignment" title="Permalink to this heading"></a></h3>
<p>Any reference may be assigned a new value:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="n">mut</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"></span>
<span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="k">assert</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Note that only mutable (<code class="code docutils literal notranslate"><span class="pre">mut</span></code>) variables or parameters can be reassigned. As this allows
some optimizations to reference counting, non-mutable variables should be preferred.</p>
</section>
<section id="if-test">
<h3>If test<a class="headerlink" href="#if-test" title="Permalink to this heading"></a></h3>
<p>If a condition is true, execute one statement, else the other:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s">&quot;2 + 2 = 4&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="s">&quot;sanity has deserted us&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>The condition of the <code class="code docutils literal notranslate"><span class="pre">if</span></code> statement may be a variable declaration.
In that case, the condition is true if the value of the variable is true.
The variable will only be visible inside the <code class="code docutils literal notranslate"><span class="pre">if</span></code> block:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Foo</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">getFoo</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// do foo things here</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">nullable</span> <span class="pre">Class</span></code> types are true if the class is non-null. In that case, the type
of the tested variable can be <code class="code docutils literal notranslate"><span class="pre">Class</span></code>. This is the only way in which <code class="code docutils literal notranslate"><span class="pre">nullable</span> <span class="pre">Class</span></code>
types can be converted to <code class="code docutils literal notranslate"><span class="pre">Class</span></code>.</p>
</section>
<section id="while-loop">
<h3>While loop<a class="headerlink" href="#while-loop" title="Permalink to this heading"></a></h3>
<p>While a condition is true, execute a statement:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="n">mut</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="for-loop">
<h3>For loop<a class="headerlink" href="#for-loop" title="Permalink to this heading"></a></h3>
<p>You can loop over a range expression:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="c1">// prints 2, then 3</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="nb">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">..</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">print</span><span class="p">(</span><span class="n">ltoa</span><span class="p">(</span><span class="n">i</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>The type of the loop variable may be left out.</p>
<p>Array expressions are ranges. Array indexes can be iterated like:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">array</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>You can also use a C-style for loop:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">mut</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">&lt;</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">+=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>But this is rarely needed.</p>
</section>
<section id="break-continue">
<h3>break, continue<a class="headerlink" href="#break-continue" title="Permalink to this heading"></a></h3>
<p>While inside any loop, you may immediately abort and continue after the loop with <code class="code docutils literal notranslate"><span class="pre">break</span></code>.</p>
<p>You may immediately jump to the next iteration of the loop with <code class="code docutils literal notranslate"><span class="pre">continue</span></code>.</p>
</section>
</section>
<section id="types">
<h2>Types<a class="headerlink" href="#types" title="Permalink to this heading"></a></h2>
<section id="basic-types">
<h3>Basic types<a class="headerlink" href="#basic-types" title="Permalink to this heading"></a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>name</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>int</p></td>
<td><p>32-bit signed integer</p></td>
</tr>
<tr class="row-odd"><td><p>short</p></td>
<td><p>16-bit signed integer</p></td>
</tr>
<tr class="row-even"><td><p>byte</p></td>
<td><p>8-bit signed integer</p></td>
</tr>
<tr class="row-odd"><td><p>char</p></td>
<td><p>8-bit UTF-8 code unit</p></td>
</tr>
<tr class="row-even"><td><p>long</p></td>
<td><p>64-bit signed integer</p></td>
</tr>
<tr class="row-odd"><td><p>void</p></td>
<td><p>0-bit empty data</p></td>
</tr>
<tr class="row-even"><td><p>size_t</p></td>
<td><p>platform-dependent unsigned word</p></td>
</tr>
<tr class="row-odd"><td><p>float</p></td>
<td><p>32-bit IEEE floating point number</p></td>
</tr>
<tr class="row-even"><td><p>double</p></td>
<td><p>64-bit IEEE floating point number</p></td>
</tr>
</tbody>
</table>
</section>
<section id="array">
<h3>Array<a class="headerlink" href="#array" title="Permalink to this heading"></a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">T[]</span></code> is an “array of T”, what some languages call a slice.
It consists of a pointer, a length and a reference to the array object.</p>
<p><code class="code docutils literal notranslate"><span class="pre">T.length</span></code> is the length of the array.</p>
<p><code class="code docutils literal notranslate"><span class="pre">[2]</span></code> is an array of ints (<code class="code docutils literal notranslate"><span class="pre">int[]</span></code>), allocated on the heap.</p>
<p><code class="code docutils literal notranslate"><span class="pre">array</span> <span class="pre">~</span> <span class="pre">array</span></code> is the concatenation of two arrays.</p>
<p>Appending to an array in a loop will follow a doubling strategy. It should be reasonably efficient.</p>
<p><code class="code docutils literal notranslate"><span class="pre">array[2]</span></code> is the third element (base-0) of the array.</p>
</section>
<section id="tuple">
<h3>Tuple<a class="headerlink" href="#tuple" title="Permalink to this heading"></a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">(int,</span> <span class="pre">float)</span></code> is a tuple with two member types, <code class="code docutils literal notranslate"><span class="pre">int</span></code> and <code class="code docutils literal notranslate"><span class="pre">float</span></code>. Each member can have an independent value.</p>
<p><code class="code docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">3.0f)</span></code> is an expression of type <code class="code docutils literal notranslate"><span class="pre">(int,</span> <span class="pre">float)</span></code>.</p>
<p><code class="code docutils literal notranslate"><span class="pre">tuple[0]</span></code> is the first member of the tuple. The index value must be an int literal.</p>
<p>Tuple members can be named: <code class="code docutils literal notranslate"><span class="pre">(int</span> <span class="pre">i,</span> <span class="pre">float</span> <span class="pre">f)</span></code>. This allows accessing the member with <code class="code docutils literal notranslate"><span class="pre">value.i</span></code>.
From a type system view, this is purely decorative.</p>
</section>
<section id="sum-type">
<h3>Sum type<a class="headerlink" href="#sum-type" title="Permalink to this heading"></a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">(int</span> <span class="pre">|</span> <span class="pre">float)</span></code> is either an int or a float value:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="kt">float</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"></span>

<span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="k">case</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">:</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">f</span><span class="p">:</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="p">/</span><span class="w"> </span><span class="mf">2.0f</span><span class="p">);</span><span class="w"></span>

<span class="n">a</span><span class="p">.</span><span class="k">case</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="n">print</span><span class="p">(</span><span class="n">itoa</span><span class="p">(</span><span class="n">i</span><span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">f</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="n">print</span><span class="p">(</span><span class="n">ftoa</span><span class="p">(</span><span class="n">f</span><span class="p">));</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Members of a sumtype can be marked as “fail”, enabling error return:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="n">FileNotFound</span><span class="p">)</span><span class="w"> </span><span class="n">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;test&quot;</span><span class="p">.</span><span class="n">readAll</span><span class="p">?.</span><span class="n">itoa</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">foo</span><span class="p">()?;</span><span class="w"></span>
</pre></div>
</div>
<p>If foo returns a <code class="code docutils literal notranslate"><span class="pre">FileNotFound</span></code>, it will be automatically returned at the <code class="code docutils literal notranslate"><span class="pre">?</span></code>.</p>
</section>
<section id="struct">
<h3>Struct<a class="headerlink" href="#struct" title="Permalink to this heading"></a></h3>
<p>A struct is a value type that combines various members and methods that operate on them:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="n">Foo</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">sum</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">Foo</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Foo</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w"></span>

<span class="k">assert</span><span class="p">(</span><span class="n">foo</span><span class="p">.</span><span class="n">sum</span><span class="p">()</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>A method is a function defined in a struct (or class). It takes a reference to the struct value it is called
on as a hidden parameter called <code class="code docutils literal notranslate"><span class="pre">this</span></code>.</p>
</section>
<section id="class">
<h3>Class<a class="headerlink" href="#class" title="Permalink to this heading"></a></h3>
<p>A class is a <strong>reference type</strong> that combines various members and methods that operate on them:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="n">Foo</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">this</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">sum</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="n">a</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">Foo</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Foo</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span><span class="w"></span>

<span class="k">assert</span><span class="p">(</span><span class="n">foo</span><span class="p">.</span><span class="n">sum</span><span class="p">()</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Note that, as opposed to C++, the type <code class="code docutils literal notranslate"><span class="pre">Foo</span></code> designates a reference to the class. It is impossible
to hold a class by value.</p>
<p><code class="code docutils literal notranslate"><span class="pre">this</span></code> is a special method without return value that designates the constructor of the class. When instantiating
a class with <code class="code docutils literal notranslate"><span class="pre">new</span> <span class="pre">Class(args)</span></code>, <code class="code docutils literal notranslate"><span class="pre">this(args)</span></code> is called.</p>
<p>The parameter <code class="code docutils literal notranslate"><span class="pre">this.a</span></code> indicates that the argument is directly assigned to the member <code class="code docutils literal notranslate"><span class="pre">a</span></code>, rather than passed to the method as a parameter.</p>
<p>Classes can be inherited with a subclass. An instance of the subclass can be implicitly converted to
the parent class. When a method is called on an instance, the function that runs is that of the
allocated class, not of the type of the reference:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="n">Foo</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">get</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">class</span><span class="w"> </span><span class="n">Bar</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Foo</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// &quot;override&quot; must be specified, to indicate</span><span class="w"></span>
<span class="w">    </span><span class="c1">// that a parent method is being redefined.</span><span class="w"></span>
<span class="w">    </span><span class="k">override</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">get</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">Foo</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Bar</span><span class="p">;</span><span class="w"></span>
<span class="k">assert</span><span class="p">(</span><span class="n">foo</span><span class="p">.</span><span class="n">get</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">7</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Classes can also inherit from interfaces, which are like “thin classes” that can only contain methods.
In exchange, arbitrarily many interfaces can be inherited from:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">interface</span><span class="w"> </span><span class="n">Foo</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">get</span><span class="p">();</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">class</span><span class="w"> </span><span class="n">Bar</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Parent</span><span class="p">,</span><span class="w"> </span><span class="n">Foo</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">override</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">get</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="n">Foo</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Bar</span><span class="p">;</span><span class="w"></span>
<span class="k">assert</span><span class="p">(</span><span class="n">foo</span><span class="p">.</span><span class="n">get</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The type of an object can be tested with the <code class="code docutils literal notranslate"><span class="pre">instanceOf</span></code> property:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="n">nullable</span><span class="w"> </span><span class="n">Bar</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">foo</span><span class="p">.</span><span class="n">instanceOf</span><span class="p">(</span><span class="n">Bar</span><span class="p">);</span><span class="w"></span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Bar</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">foo</span><span class="p">.</span><span class="n">instanceOf</span><span class="p">(</span><span class="n">Bar</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Return and parameter types follow <a class="reference external" href="https://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)">covariance and contravariance</a> on inheritance.</p>
<p>A class type may be qualified as <code class="code docutils literal notranslate"><span class="pre">nullable</span></code>. In that case, the special value
<code class="code docutils literal notranslate"><span class="pre">null</span></code> implicitly converts to a reference to the type. By default, class references are not
nullable:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="n">nullable</span><span class="w"> </span><span class="n">Foo</span><span class="w"> </span><span class="n">foo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w"></span>
<span class="k">assert</span><span class="p">(!</span><span class="n">foo</span><span class="p">);</span><span class="w"></span>
<span class="n">Foo</span><span class="w"> </span><span class="n">bar</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">foo</span><span class="p">;</span><span class="w"> </span><span class="c1">// errors</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="symbol-identifier">
<h3>Symbol Identifier<a class="headerlink" href="#symbol-identifier" title="Permalink to this heading"></a></h3>
<p>A symbol identifier takes the form <code class="code docutils literal notranslate"><span class="pre">:name</span></code>.</p>
<p>It is both a type and an expression. The type <code class="code docutils literal notranslate"><span class="pre">:name</span></code> has one value, which is also <code class="code docutils literal notranslate"><span class="pre">:name</span></code>.</p>
<p>This feature can be used to “type-tag” entries in sumtypes, to differentiate identically
typed entries, such as <code class="code docutils literal notranslate"><span class="pre">(:centimeters,</span> <span class="pre">int</span> <span class="pre">|</span> <span class="pre">:meters,</span> <span class="pre">int)</span></code>.</p>
<p>It is also used to construct “value-less” sumtype entries, such as <code class="code docutils literal notranslate"><span class="pre">(int</span> <span class="pre">|</span> <span class="pre">:none)</span></code>.</p>
</section>
<section id="typeof">
<h3><code class="code docutils literal notranslate"><span class="pre">typeof</span></code><a class="headerlink" href="#typeof" title="Permalink to this heading"></a></h3>
<p>Given an expression, the type of the expression can be used as a type with <code class="code docutils literal notranslate"><span class="pre">typeof</span></code>:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">typeof</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">b</span><span class="w"></span>
</pre></div>
</div>
<p>Since <code class="code docutils literal notranslate"><span class="pre">auto</span></code> exists, this is mostly used for return and parameter types.</p>
</section>
</section>
<section id="unittest">
<h2>Unittest<a class="headerlink" href="#unittest" title="Permalink to this heading"></a></h2>
<p>Unittest blocks will be compiled and run when the compiler is called with <code class="code docutils literal notranslate"><span class="pre">-unittest</span></code>:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">sum</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="k">unittest</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">assert</span><span class="p">(</span><span class="n">sum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="templates">
<h2>Templates<a class="headerlink" href="#templates" title="Permalink to this heading"></a></h2>
<p>A template is a wrapper around a declaration that allows parameterizing it.
The syntax is:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">T</span><span class="w"> </span><span class="n">max</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">first</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">second</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">first</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="n">second</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">first</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">second</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Here, <code class="code docutils literal notranslate"><span class="pre">T</span></code> is the “template parameter”.</p>
<p>The symbol in the template must be <em>eponymous</em>, ie. have the same name as the template. To call it,
instantiate the template: <code class="code docutils literal notranslate"><span class="pre">max!int(2,</span> <span class="pre">3)</span></code> or <code class="code docutils literal notranslate"><span class="pre">max!float(2.5,</span> <span class="pre">3)</span></code>. Here, <code class="code docutils literal notranslate"><span class="pre">max!int</span></code> is “the function <code class="code docutils literal notranslate"><span class="pre">max</span></code>
in the version of the template <code class="code docutils literal notranslate"><span class="pre">max</span></code> where <code class="code docutils literal notranslate"><span class="pre">T</span></code> is <code class="code docutils literal notranslate"><span class="pre">int</span></code>.”</p>
<p>Multiple parameters are passed in parentheses: <code class="code docutils literal notranslate"><span class="pre">templ!(int,</span> <span class="pre">float)</span></code>.</p>
<p>If the template is called directly, the types of the parameters will be used as template
parameters. This behavior is a placeholder.</p>
</section>
<section id="ranges">
<h2>Ranges<a class="headerlink" href="#ranges" title="Permalink to this heading"></a></h2>
<p>If a type <code class="code docutils literal notranslate"><span class="pre">T</span></code> has the properties <code class="code docutils literal notranslate"><span class="pre">bool</span> <span class="pre">empty</span></code>, <code class="code docutils literal notranslate"><span class="pre">T</span> <span class="pre">next</span></code> and <code class="code docutils literal notranslate"><span class="pre">E</span> <span class="pre">front</span></code>, then it is called a “range over <code class="code docutils literal notranslate"><span class="pre">E</span></code>”.</p>
<p>Arrays are an example of such.</p>
<p>Another example is range expressions: <code class="code docutils literal notranslate"><span class="pre">from</span> <span class="pre">..</span> <span class="pre">to</span></code>.</p>
<p>If you define these properties in a data type, you can use it as the source of a loop.</p>
</section>
<section id="lambdas">
<h2>Lambdas<a class="headerlink" href="#lambdas" title="Permalink to this heading"></a></h2>
<p>A lambda is a templated nested function reference. They can be assigned to a value. When called, they
are implicitly instantiated.</p>
<p>Example:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"></span>
<span class="k">auto</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="k">assert</span><span class="p">(</span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">7</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>Every lambda has a unique type. Because of this, they cannot be stored in data structures.
Their primary purpose is being passed to templated functions:</p>
<div class="highlight-d notranslate"><div class="highlight"><pre><span></span><span class="k">auto</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="w"> </span><span class="p">..</span><span class="w"> </span><span class="mi">10</span><span class="p">).</span><span class="n">filter</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="mi">0</span><span class="p">).</span><span class="n">map</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="p">/</span><span class="w"> </span><span class="mi">2</span><span class="p">).</span><span class="n">array</span><span class="p">;</span><span class="w"></span>

<span class="k">assert</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">]);</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="macros">
<h2>Macros<a class="headerlink" href="#macros" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For this feature, compiler knowledge is required!</p>
</div>
<p>When <code class="code docutils literal notranslate"><span class="pre">macro(function)</span></code> is called, <code class="code docutils literal notranslate"><span class="pre">function</span></code> is loaded into the compiler and executed with a macro state
parameter. This allows modifying the macro state of the compiler to add a macro class instance.
Macro classes can extend the compiler with new functionality using a set of hooks:</p>
<ul class="simple">
<li><p>calls: <code class="code docutils literal notranslate"><span class="pre">a(b,</span> <span class="pre">c)</span></code></p></li>
<li><p>expressions: <code class="code docutils literal notranslate"><span class="pre">2</span> <span class="pre">★</span> <span class="pre">2</span></code></p></li>
<li><p>properties: <code class="code docutils literal notranslate"><span class="pre">a.b&lt;property</span> <span class="pre">goes</span> <span class="pre">here&gt;</span></code></p></li>
<li><p>statements: <code class="code docutils literal notranslate"><span class="pre">macroThing;</span></code></p></li>
<li><p>imports: <code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">github(&quot;http://github.com/neat-lang/example&quot;).module;</span></code></p></li>
</ul>
<p>Look at <code class="code docutils literal notranslate"><span class="pre">std.macro.*</span></code> for examples.</p>
<p>The entire compiler is available for importing and reuse in macros. However, it is recommended
to limit yourself to the functionality in <code class="code docutils literal notranslate"><span class="pre">neat.base</span></code>. This will also keep compile times down.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Neat</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Neat Language</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#lexical">Lexical</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#packages">Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-level-statements">Module-Level Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#expressions">Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#statements">Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#types">Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unittest">Unittest</a></li>
<li class="toctree-l2"><a class="reference internal" href="#templates">Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ranges">Ranges</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lambdas">Lambdas</a></li>
<li class="toctree-l2"><a class="reference internal" href="#macros">Macros</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="std.html">Standard Library</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="intro.html" title="previous chapter">Introduction</a></li>
      <li>Next: <a href="std.html" title="next chapter">Standard Library</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, @FeepingCreature.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/manual.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>